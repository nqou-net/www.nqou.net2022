---
categories:
  - 情報技術について
comment: false
date: 2014-03-02 23:46:54
id: 1677
iso8601: 2014-03-02T23:46:54+09:00
tags:
  - wordpress
title: 「HTML Import 2」は超便利でした

---

<p><a href="https://twitter.com/nqounet">@nqounet</a>です。</p>

<p>ここのところWordpressばかりいじっているような気がします。</p>

<p>ということで、今日はその関係のネタです。</p>



<p>今回、ブログを引っ越すに際して、過去記事をインポートしようと思っていました。</p>

<p>bloggerを使っていた前回で、すでに3つに点在していたので、一つに集めようと思いました。</p>

<p>一番古いMT3時代の記事が、出力後のHTMLファイルしかなくて困っていたんですが、それを解決してくれるプラグインがありました。</p>

<p><a href="http://wordpress.org/plugins/import-html-pages/">HTML Import 2</a>です。</p>

<p>これは、HTMLファイルからスクレイピングしてインポートしてくれるので、必要な部分をタグで示してやればうまくインポートしてくれます。</p>

<p><a href="http://www.nqou.net/wp-content/uploads/2014/03/html-import2.png"><img src="http://www.nqou.net/wp-content/uploads/2014/03/html-import2-300x187.png" alt="html-import2" width="300" height="187" class="alignnone size-medium wp-image-1679" /></a></p>

<p>もともと機械的に出力したものなので、構造がしっかりしていて読み込みが簡単そうでした。</p>

<p>ただ、一番困ったのが時間です。</p>

<p>ファイルの更新時を取得する、という方法が示されていたのですが、さすがにそれは無理でした。</p>

<p>で、なにか情報がないかと思ってソースを眺めていたら、コメントの中に更新時間のメタ情報（<code>&lt;dc:date></code>）があったので、それを使うことにしました。</p>

<p>このプラグインはコメント部分は無視するのか、あるいは無効な文字があるのか</p>

<p>スクリプトを書こうかと思ったのですが、1回しか使わないので、エディタを使っていくつか加工してからインポートしました。</p>

<p>加工したのは以下のとおり。</p>

<ul>
<li>コメントを外す（開始タグ（<code>&lt;!--</code>）のみを適当に置き換えました）</li>
<li><code>&lt;dc:date></code>の部分を<code>&lt;div id="entry-date"></code>で読めるように置き換え</li>
<li>moreを作るために、<code>&lt;/div></code>から<code>&lt;div class="entry-more"></code>までのタグを削除</li>
</ul>

<p>こうすることで、<code>&lt;div class="entry-body"></code>を読み込むだけで綺麗にインポートできるようになりました。</p>

<h2>時間のかかる処理は控えめに</h2>

<p>インポートした記事数は全部で350弱だったと思いますが、さすがにHTTP越しでやるとブラウザが固まったようになります。</p>

<p>返ってきたと思ったら真っ白な画面だったので、インポートできていないのかと思いましたが、確認するとちゃんと出来ていました。</p>

<p>プラグインがどこまで可能なのかはわかりませんが、こういう処理の見せ方がもう少し丁寧に作りこまれるといいなぁ、と思いました。</p>
    	